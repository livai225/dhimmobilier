{
  "permissions": {
    "allow": [
      "Bash(npm install)",
      "Bash(npm run build:*)",
      "Bash(timeout 5 npm start:*)",
      "Bash(pkill:*)",
      "Bash(kill:*)",
      "Bash(lsof:*)",
      "Bash(netstat:*)",
      "Bash(fuser:*)",
      "Bash(curl:*)",
      "Bash(__NEW_LINE_00ebdaf91dcf08b3__ echo -e \"\\\\n=== Test RPC avec montant invalide ===\")",
      "Bash(__NEW_LINE_f80753e390103805__ echo -e \"\\\\n=== Test paramètre manquant ===\")",
      "Bash(fi)",
      "Bash(COOKIE=\"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJkMTBkNTg4Zi02NDI3LTRlMzAtYWM1NC0wZGQzYmNlNmViNGQiLCJyb2xlIjoiYWRtaW4iLCJpYXQiOjE3Njk3MzYxODYsImV4cCI6MTc2OTc3OTM4Nn0.sHjRZJeTElDcqvQCqg3Lo_fbYJQAk06AyOqMbpjVT1A\")",
      "Bash(__NEW_LINE_5397f0208a2cb870__ echo \"=== Test location introuvable \\(404\\) ===\")",
      "Bash(__NEW_LINE_3cd3a2e3ca825662__ curl -s -X POST http://localhost:3001/rpc/pay_location_with_cash -H \"Content-Type: application/json\" -H \"Cookie: dhimmobilier_session=$COOKIE\" -d '{\"\"location_id\"\": \"\"non-existant-id\"\", \"\"montant\"\": 1000}')",
      "Bash(git add:*)",
      "Bash(git commit:*)",
      "Bash(git push)",
      "Bash(grep:*)",
      "Bash(npx prisma generate:*)",
      "Bash(npx prisma:*)",
      "Bash(mysql:*)",
      "Bash(mysql -u dhimmobilier -pdhimmobilier -e:*)",
      "Bash(pm2 list:*)",
      "Bash(systemctl list-units:*)",
      "Bash(pm2 restart:*)",
      "Bash(pm2 show:*)",
      "Bash(pm2 logs:*)",
      "Bash(nginx -t:*)",
      "Bash(systemctl reload:*)",
      "Bash(service nginx reload:*)",
      "Bash(ls:*)",
      "Bash(# Test avec le cookie de session curl -s -c /tmp/cookies.txt -X POST \"\"http://127.0.0.1:3001/auth/login\"\" \\\\ -H \"\"Content-Type: application/json\"\" \\\\ -d ''{\"\"username\"\":\"\"admin\"\",\"\"password\"\":\"\"admin123\"\"}'' curl -s -b /tmp/cookies.txt -X POST \"\"http://127.0.0.1:3001/db/select\"\" \\\\ -H \"\"Content-Type: application/json\"\" \\\\ -d ''{\"\"table\"\":\"\"secteurs_activite\"\",\"\"orderBy\"\":{\"\"column\"\":\"\"nom\"\",\"\"ascending\"\":true}}'' 2>&1)",
      "Bash(# Test rapide des endpoints critiques echo \"\"=== Test API Backend ===\"\" # 1. Login pour obtenir session curl -s -c /tmp/cookies.txt -X POST \"\"http://127.0.0.1:3001/auth/login\"\" \\\\ -H \"\"Content-Type: application/json\"\" \\\\ -d ''{\"\"username\"\":\"\"admin\"\",\"\"password\"\":\"\"admin123\"\"}'' # 2. Test select locations echo \"\"1. Locations:\"\" curl -s -b /tmp/cookies.txt -X POST \"\"http://127.0.0.1:3001/db/select\"\" \\\\ -H \"\"Content-Type: application/json\"\" \\\\ -d ''{\"\"table\"\":\"\"locations\"\",\"\"limit\"\":1}'')",
      "Bash(__NEW_LINE_9266cfd6abf32c96__ echo -e \"\\\\n=== Fin tests ===\")",
      "Bash(__NEW_LINE_0b74cce4e3870415__ echo -e \"\\\\n4. Propriétés libres:\")",
      "Bash(__NEW_LINE_bd73e2c39896cf82__ echo -e \"\\\\n=== Fin ===\")",
      "Bash(python3:*)",
      "Bash(NODE_OPTIONS=\"--max-old-space-size=512\" npm run build:*)",
      "Bash(NODE_OPTIONS=\"--max-old-space-size=1024\" npm run build:*)",
      "Bash(git -C /var/www/dhimmobilier/server log --all --oneline --graph --date=short -30)",
      "Bash(git -C /var/www/dhimmobilier/server reflog:*)",
      "Bash(git -C /var/www/dhimmobilier/server stash list)",
      "Bash(git -C /var/www/dhimmobilier/server branch -a)",
      "Bash(git -C /var/www/dhimmobilier/server fsck --unreachable --no-reflogs)",
      "Bash(git -C /var/www/dhimmobilier/server log origin/main --oneline -10)",
      "Bash(git -C /var/www/dhimmobilier/server fetch origin)",
      "Bash(git -C /var/www/dhimmobilier/server stash show:*)",
      "Bash(git -C /var/www/dhimmobilier/server diff HEAD --stat)",
      "Bash(git -C /var/www/dhimmobilier/server fetch --all)",
      "Bash(git -C /var/www/dhimmobilier/server log --all --oneline --date=short --after=\"2026-02-01\")",
      "Bash(sync)",
      "Bash(sudo tee:*)",
      "Bash(NODE_OPTIONS=\"--max-old-space-size=1536\" npx vite build:*)",
      "Bash(ps:*)",
      "Bash(pm2 start:*)",
      "Bash(journalctl:*)",
      "Bash(pm2 status:*)",
      "Bash(systemctl status:*)",
      "Bash(dmesg:*)",
      "Bash(node -e:*)",
      "Bash(pm2 prettylist:*)",
      "Bash(sudo journalctl:*)",
      "Bash(sudo fallocate:*)",
      "Bash(sudo chmod:*)",
      "Bash(sudo mkswap:*)",
      "Bash(sudo swapon:*)",
      "Bash(find:*)",
      "Bash(wc:*)",
      "Bash(cat:*)",
      "Bash(sudo sed -i:*)",
      "Bash(sudo nginx:*)",
      "Bash(sudo mv:*)",
      "Bash(/tmp/nginx-dhimmobilier-patch.conf << 'NGINX_EOF'\nserver {\n    listen 80 default_server;\n    listen [::]:80 default_server;\n    root /var/www/html;\n    index index.html index.htm;\n    server_name _;\n    location / {\n        try_files $uri $uri/ /index.html;\n    }\n}\n\nserver {\n    listen 80;\n    listen [::]:80;\n    server_name 82.208.22.230;\n    root /var/www/html;\n    index index.html index.htm;\n\n    location /api {\n        proxy_pass http://localhost:3000;\n        proxy_http_version 1.1;\n        proxy_set_header Upgrade $http_upgrade;\n        proxy_set_header Connection upgrade;\n        proxy_set_header Host $host;\n        proxy_cache_bypass $http_upgrade;\n    }\n\n    location /dhimmobilier-api/ {\n        proxy_pass http://127.0.0.1:3001/;\n        proxy_http_version 1.1;\n        proxy_set_header Upgrade $http_upgrade;\n        proxy_set_header Connection upgrade;\n        proxy_set_header Host $host;\n        proxy_set_header X-Real-IP $remote_addr;\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n        proxy_set_header X-Forwarded-Proto $scheme;\n        proxy_cache_bypass $http_upgrade;\n    }\n\n    # Hashed static assets: long cache \\(Vite puts them in /assets/\\)\n    location /dhimmobilier/assets/ {\n        alias /var/www/dhimmobilier/server/dist/assets/;\n        expires 30d;\n        add_header Cache-Control \"public, immutable\";\n        add_header X-Content-Type-Options \"nosniff\";\n    }\n\n    location /dhimmobilier/ {\n        alias /var/www/dhimmobilier/server/dist/;\n        try_files $uri $uri/ /dhimmobilier/index.html;\n        add_header X-Content-Type-Options \"nosniff\";\n    }\n\n    location / {\n        try_files $uri $uri/ /index.html;\n    }\n}\nNGINX_EOF)",
      "Bash(sudo cp:*)",
      "Bash(npm install:*)",
      "Bash(sudo systemctl reload:*)",
      "Bash(npm info:*)",
      "Bash(npx tsc:*)",
      "Bash(npx vite build:*)",
      "Bash(pm2 flush:*)",
      "Bash(node --version:*)",
      "Bash(sudo systemctl status:*)",
      "Bash(sudo systemctl start:*)",
      "WebFetch(domain:82.208.22.230)",
      "Bash(sort:*)"
    ]
  }
}
